'''
test_mmlwl16.py

:Authors:         Seung Geol Choi
:Date:            08/2020
'''

from charm.toolbox.pairinggroup import PairingGroup, GT
from mmlwl16 import MMLWL16
import pickle
from charm.core.engine.util import objectToBytes, bytesToObject
from charm.toolbox.symcrypto import AuthenticatedCryptoAbstraction, SymmetricCryptoAbstraction
from charm.core.math.pairing import hashPair as extractor
import json

pairing_group = PairingGroup('SS512')

def obToBy(dic):
    return objectToBytes(dic, pairing_group)

def byToOb(bytes):
    return bytesToObject(bytes, pairing_group)

def readFile(fileName):
    readF = open(fileName, 'rb')
    return readF


def main():
    # instantiate a bilinear pairing map
    pairing_group = PairingGroup('SS512')
    
    cpabe = MMLWL16(pairing_group, 2)

    # run the set up
    # (pk, msk) = cpabe.setup()

    # generate a key
    # attr_list = ['Senior_Doctor', 'TWO', 'THREE']
    # attr_list = ['ORTHO', 'GYNAECOLOGY', 'BILLING']             #Attribute list should be in Block Letters
    # key = cpabe.keygen(pk, msk, attr_list)

    # choose a random message
    msg = ['hello', 'world']
    # msg = ['the', 'patient', 'was', 'tested', 'for', 'myalgia', 'on', 'the', 'left', 'elbow blood', 'tests', 'were', 'conducted', 'to', 'detect', 'inflammation', 'and', 'to', 'rule', 'out', 'underlying', 'conditions ', 'these', 'included', 'a', 'complete', 'blood', 'count', 'cbc,', 'esr', 'erythrocyte', 'sedimentation', 'rate,', 'electrolytes,', 'hormone', 'levels,', 'calcium,', 'phosphate,', 'serum', 'enzymes', 'levels,', 'and', 'serological', 'tests physical', 'tests', 'included', 'gait', 'posture', 'and', 'coordination', 'for', 'any', 'abnormal', 'movements ', 'muscles', 'were', 'inspected', 'for', 'any', 'evidence', 'of', 'wasting', 'atrophy', 'enlargement', 'hypertrophy', 'or', 'permanent', 'shortening', 'contracture ', 'muscle', 'tone', 'natural', 'tension', 'and', 'strength', 'were', 'assessed', 'through', 'range-of-motion', 'and', 'resistance', 'exercises ', 'the', 'patient', 'has', 'been', 'prescribed', 'the', 'following', 'medication', 'aleve', 'oral', 'myoflex', 'topical', 'these', 'are', 'oral', 'tablets', 'with', 'respect', 'to', 'the', 'current', 'diagnoses', 'the', 'following', 'medication', 'is', 'prescribed', 'lidocaine', 'patches', 'aspercreme', 'capzasin-p', 'the', 'patient', 'is', 'advised', 'to', 'apply', 'the', 'creme', 'times', 'a', 'day', 'over', 'the', 'painful', 'area', 'the', 'patient', 'is', 'also', 'advised', 'to', 'take', 'the', 'other', 'tablets', 'two', 'times', 'a', 'day', 'after', 'every', 'meal ', 'caution', 'in', 'case', 'of', 'any', 'allergies', 'please', 'discontinue', 'the', 'medicines', 'immediately', 'and', 'consult', 'the', 'doctor', 'the', 'patient', 'has', 'not', 'been', 'observed', 'with', 'any', 'allergies', 'the', 'patient', 'has', 'been', 'treated', 'briefly', 'for', 'the', 'muscle', 'pain', 'lab', 'technicians', 'are', 'requested', 'to', 'conduct', 'tests', 'for', 'myalgia', 'and', 'report', 'the', 'results', 'promptly the', 'results', 'will', 'decide', 'further', 'medication', 'patient', 'is', 'advised', 'to', 'use', 'ice', 'packs', 'times', 'a', 'day', 'for', 'a', 'week ', 'the', 'patient', 'presents', 'with', 'abnormally', 'high', 'stiffness', 'in', 'the', 'left', 'elbow', 'the', 'patient', 'left', 'arm', 'causes', 'pain', 'on', 'moving', 'it', 'in', 'the', 'lateral', 'direction,', 'with', 'no', 'pain', 'on', 'vertical', 'motion tests', 'have', 'been', 'ordered', 'to', 'assess', 'the', 'cause', 'of', 'this', 'abnormal', 'pain', 'diagnoses', 'myalgia', 'the', 'patient', 'does', 'not', 'require', 'any', 'immunizations', 'for', 'the', 'concerned', 'ailment ', 'after', 'receiving', 'further', 'details', 'from', 'the', 'medical', 'insurance', 'company,', 'the', 'billing', 'details', 'will', 'be', 'updated', 'in', 'a', 'minimum', 'of', '7', 'working', 'days ', 'lab', 'results', 'are', 'as', 'follows,', 'patient', 'suffers', 'from', 'shoulder', 'pain', 'due', 'to', 'muscle', 'pull ', 'nothing', 'serious ', 'the', 'patient', 'has', 'been', 'prescribed', 'the', 'following', 'medication,', 'calcium', 'tablets', 'the', 'patient', 'is', 'advised', 'to', 'follow', 'as', 'written', 'below,', 'over-the-counter', 'calcium', 'tablets', 'is', 'fine', 'the', 'patient', 'is', 'allergic', 'to', 'none', 'this', 'shoulder', 'stretch', 'sometimes', 'helps', 'cross', 'one', 'arm', 'over', 'your', 'body', 'use', 'your', 'other', 'arm', 'to', 'pull', 'the', 'elbow', 'of', 'your', 'outstretched', 'arm', 'toward', 'your', 'chest', 'hold', 'this', 'stretch', 'for', 'about', '10', 'seconds', 'discontinue', 'if', 'pain', 'continues', 'or', 'aggravates', 'the', 'patient', 'has', 'been', 'diagnosed', 'with', 'interscapular', 'pain', 'or', 'shoulder', 'blade', 'pain', 'patient', 'suffers', 'from', 'aching', 'dull,', 'sore', 'and', 'shooting', 'pain', 'in', 'the', 'upper', 'part', 'of', 'back', 'between', 'shoulder', 'blades', 'the', 'patient', 'immunization', 'schedule', 'is', 'june', '29', '2014', 'the', 'patient', 'has', 'been', 'billed', 'as', 'follows', 'doctor', 'charges', 'doctor', 'visit', 'charges', 'medical', 'insurance', 'coverage', 'total', 'expenses', 'to', 'be', 'paid', 'lab', 'results', 'are', 'as', 'follows', 'patient', 'suffers', 'from', 'shoulder', 'pain', 'due', 'to', 'muscle', 'pull ', 'nothing', 'serious', 'the', 'patient', 'has', 'been', 'prescribed', 'the', 'following', 'medication,', 'calcium', 'tablets', 'the', 'patient', 'is', 'advised', 'to', 'follow', 'as', 'written', 'below,', 'over-the-counter', 'calcium', 'tablets', 'is', 'fine', 'the', 'patient', 'is', 'allergic', 'to', 'none', 'this', 'shoulder', 'stretch', 'sometimes', 'helps', 'cross', 'one', 'arm', 'over', 'your', 'body ', 'use', 'your', 'other', 'arm', 'to', 'pull', 'the', 'elbow', 'of', 'your', 'outstretched', 'arm', 'toward', 'your', 'chest' 'hold', 'this', 'stretch', 'for', 'about', 'seconds', 'discontinue', 'if', 'pain', 'continues', 'or', 'aggravates ', 'the', 'patient', 'has', 'been', 'diagnosed', 'with', 'interscapular', 'pain', 'or', 'shoulder', 'blade', 'pain', 'patient', 'suffers', 'from', 'aching,', 'dull', 'sore', 'and', 'shooting', 'pain', 'in', 'the', 'upper', 'part', 'of', 'back', 'between', 'shoulder', 'blades ', 'the', 'patient', 'immunization', 'schedule', 'june', 'the', 'patient', 'has', 'been', 'billed', 'as', 'follows', 'doctor', 'charges', 'doctor', 'visit', 'charges', 'medical', 'insurance', 'coverage', 'total', 'expenses', 'to', 'be', 'paid', 'lab', 'results', 'are', 'as', 'follows', 'patient', 'suffers', 'from', 'shoulder', 'pain', 'due', 'to', 'muscle', 'pull', 'nothing', 'serious', 'the', 'patient', 'has', 'been', 'prescribed', 'the', 'following', 'medication', 'calcium', 'tablets', 'the', 'patient', 'is', 'advised', 'to', 'follow', 'as', 'written', 'below,', 'over-the-counter', 'calcium', 'tablets', 'is', 'fine', 'the', 'patient', 'is', 'allergic', 'to', 'none', 'this', 'shoulder', 'stretch', 'sometimes', 'helps', 'cross', 'one', 'arm', 'over', 'your', 'body', 'use', 'your', 'other', 'arm', 'to', 'pull', 'the', 'elbow', 'of', 'your', 'outstretched', 'arm', 'toward', 'your', 'chest', 'hold', 'this', 'stretch', 'for', 'about', 'seconds', 'discontinue', 'if', 'pain', 'continues', 'or', 'aggravates ', 'the', 'patient', 'has', 'been', 'diagnosed', 'with', 'interscapular', 'pain', 'or', 'shoulder', 'blade', 'pain', 'patient', 'suffers', 'from', 'aching', 'dull,', 'sore,', 'and', 'shooting', 'pain', 'in', 'the', 'upper', 'part', 'of', 'back', 'between', 'shoulder', 'blades', 'the', 'patient', 'immunization', 'schedule', 'june', 'the', 'patient', 'has', 'been', 'billed', 'as', 'follows', 'doctor', 'charges', 'doctor', 'visit', 'charges', 'medical', 'insurance', 'coverage', 'total', 'expenses', 'to', 'be', 'paid', 'lab', 'results', 'are', 'as', 'follows,', 'patient', 'suffers', 'from', 'shoulder', 'pain', 'due', 'to', 'muscle', 'pull ', 'nothing', 'serious', 'the', 'patient', 'has', 'been', 'prescribed', 'the', 'following', 'medication,', 'calcium', 'tablets', 'the', 'patient', 'is', 'advised', 'to', 'follow', 'as', 'written', 'below,', 'over-the-counter', 'calcium', 'tablets', 'is', 'fine', 'the', 'patient', 'is', 'allergic', 'to', 'none', 'this', 'shoulder', 'stretch', 'sometimes', 'helps', 'cross', 'one', 'arm', 'over', 'your', 'body ', 'use', 'your', 'other', 'arm', 'to', 'pull', 'the', 'elbow', 'of', 'your', 'outstretched', 'arm', 'toward', 'your', 'chest', 'hold', 'this', 'stretch', 'for', 'about', 'seconds ', 'discontinue', 'if', 'pain', 'continues', 'or', 'aggravates ', 'the', 'patient', 'has', 'been', 'diagnosed', 'with', 'interscapular', 'pain', 'or', 'shoulder', 'blade', 'pain', 'patient', 'suffers', 'from', 'aching,', 'dull', 'sore,', 'and', 'shooting', 'pain', 'in', 'the', 'upper', 'part', 'of', 'back', 'between', 'shoulder', 'blades ', 'the', 'patient', 'immunization', 'schedule', 'june', '29,', '2014', 'the', 'patient', 'has', 'been', 'billed', 'as', 'follows', 'doctor', 'charges', 'doctor', 'visit', 'charges', 'medical', 'insurance', 'coverage$0', 'total', 'expenses', 'to', 'be', 'paid', 'the', 'hb', 'levels', 'are', 'normal ', 'the', 'patient', 'has', 'been', 'prescribed', 'the', 'following', 'medication,', 'meftalspas', 'the', 'patient', 'is', 'advised', 'to', 'follow', 'as', 'written', 'below', 'nature', 'made', 'iron', 'dietary', 'supplement', 'tablets', 'no', 'allergies ', 'the', 'patient', 'healthy', 'and', 'fit ', 'some', 'exercies', 'have', 'been', 'shown', 'which', 'will', 'help', 'the', 'patient', 'in', 'easening', 'mentrual', 'cramps ', 'the', 'patient', 'has', 'been', 'checked', 'for', 'general', 'body', 'health the', 'patient', 'shows', 'consistent', 'and', 'healthy', 'menstrual', 'patterns the', 'heamoglobin', 'levels', 'are', 'little', 'low,', 'but', 'not', 'very', 'serious ', 'iron', 'shots ', 'the', 'patient', 'has', 'been', 'billed', 'as', 'follows,', 'full', 'body', 'check-up', 'full', 'body', 'check-up', 'medical', 'insurance', 'converage', 'total', 'expenses', 'to', 'be', 'pais', 'the', 'patient', 'was', 'tested', 'for', 'myalgia', 'on', 'the', 'left', 'elbow blood', 'tests', 'were', 'conducted', 'to', 'detect', 'inflammation', 'and', 'to', 'rule', 'out', 'underlying', 'conditions ', 'these', 'included', 'a', 'complete', 'blood', 'count', 'cbc,', 'esr', 'erythrocyte', 'sedimentation', 'rate,', 'electrolytes,', 'hormone', 'levels,', 'calcium,', 'phosphate,', 'serum', 'enzymes', 'levels,', 'and', 'serological', 'tests physical', 'tests', 'included', 'gait,', 'posture,', 'and', 'coordination', 'for', 'any', 'abnormal', 'movements ', 'muscles', 'were', 'inspected', 'for', 'any', 'evidence', 'of', 'wasting', 'atrophy,', 'enlargement', 'hypertrophy', 'or', 'permanent', 'shortening', 'contracture ', 'muscle', 'tone', 'natural', 'tension', 'and', 'strength', 'were', 'assessed', 'through', 'range-of-motion', 'and', 'resistance', 'exercises ', 'the', 'patient', 'has', 'been', 'prescribed', 'the', 'following', 'medication', 'aleve', 'oral', 'myoflex', 'topical', 'with', 'respect', 'to', 'the', 'current', 'diagnoses', 'the', 'following', 'medication', 'is', 'prescribed', 'lidocaine', 'patches', 'aspercreme', 'capzasin-p', 'the', 'patient', 'is', 'advised', 'to', 'apply', 'the', 'creme', 'times', 'a', 'day', 'over', 'the', 'painful', 'area', 'the', 'patient', 'is', 'also', 'advised', 'to', 'take', 'the', 'other', '2', 'tablets', 'two', 'times', 'a', 'day', 'after', 'every', 'meal', 'caution', 'in', 'case', 'of', 'any', 'allergies,', 'please', 'discontinue', 'the', 'medicines', 'immediately', 'and', 'consult', 'the', 'doctor', 'the', 'patient', 'has', 'not', 'been', 'observed', 'with', 'any', 'allergies ', 'the', 'patient', 'has', 'been', 'treated', 'briefly', 'for', 'the', 'muscle', 'pain ', 'lab', 'technicians', 'are', 'requested', 'to', 'conduct', 'tests', 'for', 'myalgia', 'and', 'report', 'the', 'results', 'promptly the', 'results', 'will', 'decide', 'further', 'medication ', 'the', 'patient', 'presents', 'with', 'abnormally', 'high', 'stiffness', 'in', 'the', 'left', 'elbow ', 'the', 'patient', 'left', 'arm', 'causes', 'pain', 'on', 'moving', 'it', 'in', 'the', 'lateral', 'direction,', 'with', 'no', 'pain', 'on', 'vertical', 'motion tests', 'have', 'been', 'ordered', 'to', 'assess', 'the', 'cause', 'of', 'this', 'abnormal', 'pain diagnoses', 'myalgia', 'the', 'patient', 'does', 'not', 'require', 'any', 'immunizations', 'for', 'the', 'concerned', 'ailment ', 'after', 'receiving', 'further', 'details', 'from', 'the', 'medical', 'insurance', 'company,', 'the', 'billing', 'details', 'will', 'be', 'updated', 'in', 'a', 'minimum', 'of', 'working', 'days ', 'no', 'tests', 'needed ', 'the', 'patient', 'does', 'not', 'need', 'any', 'medication ', 'the', 'patient', 'bone', 'health', 'is', 'good ', 'regular', 'exercise', 'to', 'be', 'continued ', 'no', 'medication ', 'no', 'allergies', 'recorded ', 'keep', 'up', 'the', 'good', 'exercise', 'routine ', 'healthy', 'bones ', 'no', 'immunization', 'required ', 'the', 'patient', 'has', 'been', 'billed', 'as', 'follows,', 'doctor', 'visit', 'doctor', 'examination', 'charges', '$400', 'medical', 'insurance', 'claimed', 'total', 'expenses', 'to', 'be', 'paid', 'the', 'patient', 'was', 'tested', 'for', 'beta-human', 'chorionic', 'gonadotropin', 'serial', 'hcg', 'monitoring', 'false', 'positive', 'hcg', 'results', 'early', 'pregnancy', 'factor', 'the', 'patient', 'has', 'been', 'prescribed', 'the', 'following', 'medication', 'emetrex', 'monistat', 'or', 'terazol', 'the', 'patient', 'is', 'advised', 'to', 'follow', 'exercises', 'as', 'shown', 'during', 'the', 'visit', 'and', 'follow', 'the', 'prescribed', 'medicines', 'regularly ', 'the', 'patient', 'is', 'allergic', 'to', 'ibuprofen', 'the', 'patient', 'is', 'in', 'her', 'first', 'trimester', 'of', 'pregnancy extra', 'care', 'is', 'advised', 'after', 'examining', 'the', 'menstrual', 'pattern,', 'the', 'patient', 'has', 'been', 'confirmed', 'for', 'pregnancy ', 'the', 'patient', 'has', 'been', 'examined', 'for', 'amenorrhea', 'nausea', 'vomiting', 'generalized', 'malaise,', 'and', 'breast', 'tenderness', 'the', 'symptoms', 'and', 'tests', 'confirm', 'pregnancy ', 'the', 'patient', 'is', 'being', 'currently', 'administered', 'with', 'flu', 'influenza', 'shot', 'tetanus', 'toxoid,', 'reduced', 'diphtheria', 'toxoid', 'and', 'acellular', 'pertussis', 'tdap', 'vaccine', 'the', 'patient', 'has', 'been', 'billed', 'as', 'follows,', 'doctor', 'visit', 'doctor', 'visit', 'sonography', 'lab', 'tests', 'medical', 'insurance', 'coverage', 'total', 'expense', 'to', 'be', 'paid', 'the', 'patient', 'was', 'tested', 'for', 'beta-human', 'chorionic', 'gonadotropin', '', 'serial', 'hcg', 'monitoring', '', 'false', 'positive', 'hcg', 'results','early', 'pregnancy', 'factor', 'the', 'patient', 'has', 'been', 'prescribed', 'the', 'following', 'medication', 'emetrex', 'monistat', 'or', 'terazol', '', 'the', 'patient', 'is', 'advised', 'to', 'follow', 'exercises', 'as', 'shown', 'during', 'the', 'visit', 'and', 'follow', 'the', 'prescribed', 'medicines', 'regularly ', 'the', 'patient', 'is', 'allergic', 'to', 'ibuprofen', 'the', 'patient', 'is', 'in', 'her', 'first', 'trimester', 'of', 'pregnancy extra', 'care', 'is', 'advised', 'after', 'examining', 'the', 'menstrual', 'pattern,', 'the', 'patient', 'has', 'been', 'confirmed', 'for', 'pregnancy ', 'the', 'patient', 'has', 'been', 'examined', 'for', 'amenorrhea,', 'nausea,', 'vomiting,', 'generalized', 'malaise,', 'and', 'breast', 'tenderness', 'the', 'symptoms', 'and', 'tests', 'confirm', 'pregnancy ', 'the', 'patient', 'is', 'being', 'currently', 'administered', 'with,', 'flu', 'influenza', 'shot', '', 'tetanus', 'toxoid,', 'reduced', 'diphtheria', 'toxoid', 'and', 'acellular', 'pertussis', 'tdap', 'vaccine', 'the', 'patient', 'has', 'been', 'billed', 'as', 'follows,', 'doctor', 'visit', 'doctor', 'visit', 'sonography', 'lab', 'tests', '$2200', '', 'medical', 'insurance', 'coverage', '$2500', '', 'total', 'expense', 'to', 'be', 'paid', '$1390', 'the', 'patient', 'was', 'tested', 'for', 'beta-human', 'chorionic', 'gonadotropin', 'serial', 'hcg', 'monitoring', 'false', 'positive', 'hcg', 'results', 'early', 'pregnancy', 'factor', 'the', 'patient', 'has', 'been', 'prescribed', 'the', 'following', 'medication,', 'emetrex', 'monistat', 'or', 'terazol', '', 'the', 'patient', 'is', 'advised', 'to', 'follow', 'exercises', 'as', 'shown', 'during', 'the', 'visit', 'and', 'follow', 'the', 'prescribed', 'medicines', 'regularly ', 'the', 'patient', 'is', 'allergic', 'to', 'ibuprofen', 'the', 'patient', 'is', 'in', 'her', 'first', 'trimester', 'of', 'pregnancy extra', 'care', 'is', 'advised ', 'after', 'examining', 'the', 'menstrual', 'pattern,', 'the', 'patient', 'has', 'been', 'confirmed', 'for', 'pregnancy the', 'patient', 'has', 'been', 'examined', 'for', 'amenorrhea', 'nausea,', 'vomiting,', 'generalized', 'malaise,', 'and', 'breast', 'tenderness the', 'symptoms', 'and', 'tests', 'confirm', 'pregnancy ', 'the', 'patient', 'is', 'being', 'currently', 'administered', 'with,', 'flu', 'influenza', 'shot', 'tetanus', 'toxoid,', 'reduced', 'diphtheria', 'toxoid', 'and', 'acellular', 'pertussis', 'tdap', 'vaccine', '', 'the', 'patient', 'has', 'been', 'billed', 'as', 'follows,', 'doctor', 'visit', 'doctor', 'visit', 'sonography', 'lab', 'tests', 'medical', 'insurance', 'coverage', 'total', 'expense', 'to', 'be', 'paid', 'the', 'patient', 'was', 'tested', 'for', 'tendinitis', 'a', 'ct', 'scan', 'was', 'conducted the', 'results', 'show', 'positive', 'for', 'tendinitis ', 'the', 'cross', 'sectional', 'images', 'of', 'both', 'the', 'knees', 'show', 'severe', 'bone', 'damage ', 'the', 'patient', 'is', 'prescribed', 'with,', 'bone', 'strength', 'take', 'care™', 'slim', 'tablets', 'ultimate', 'bone', 'support', 'talbets', 'the', 'patient', 'is', 'advised', 'to', 'take', 'over-the-counter', 'calcium', 'tablets along', 'with', 'this,', 'the', 'patient', 'is', 'advised', 'to', 'massage', 'the', 'painful', 'area', 'everyday', 'before', 'going', 'to', 'bed', 'with', 'sessame', 'oil avoid', 'sleeping', 'on', 'your', 'side ', 'use', 'pillows', 'positioned', 'on', 'either', 'side', 'of', 'your', 'body', 'to', 'prevent', 'you', 'from', 'rolling', 'onto', 'your', 'side ', 'when', 'lying', 'on', 'your', 'side,', 'keep', 'a', 'pillow', 'between', 'your', 'knees ', 'the', 'patient', 'is', 'allergic', 'to', 'ibuprofen', 'warm', 'up', 'before', 'exercise ', 'stretch', 'your', 'quadriceps', 'and', 'hamstrings', 'before', 'and', 'after', 'exercise', 'try', 'low-impact', 'exercises ', 'instead', 'of', 'tennis', 'or', 'running,', 'give', 'swimming', 'or', 'bicycling', 'a', 'shot ', 'or', 'mix', 'low-impact', 'exercises', 'with', 'high-impact', 'exercises', 'to', 'give', 'your', 'knees', 'a', 'break', 'lose', 'weight ', '', 'walk', 'down', 'hills ', 'running', 'puts', 'extra', 'force', 'on', 'your', 'knee ', 'instead', 'of', 'running', 'down', 'an', 'incline,', 'walk ', '', 'stick', 'to', 'paved', 'surfaces ', 'rough', 'roads', 'or', 'pocked', 'walkways', 'may', 'be', 'hazardous', 'to', 'your', 'knee’s', 'health ', 'stick', 'to', 'smooth,', 'paved', 'surfaces', 'like', 'a', 'track', 'or', 'walking', 'arena ', '', 'get', 'support ', 'shoe', 'inserts', 'can', 'help', 'treat', 'foot', 'or', 'gait', 'problems', 'that', 'may', 'be', 'contributing', 'to', 'knee', 'pain ', '', 'replace', 'your', 'running', 'shoes', 'frequently', 'to', 'ensure', 'they', 'still', 'have', 'proper', 'support', 'and', 'cushioning ', '', 'the', 'patient', 'has', 'been', 'diagnosed', 'with,', 'tendinitis patient', 'suufers', 'from', 'pain', 'in', 'the', 'front', 'of', 'the', 'knee ', 'this', 'causes', 'the', 'patient', 'severe', 'pain', 'when', 'climbing,', 'taking', 'stairs,', 'or', 'walking', 'up', 'an', 'incline ', 'the', 'patient', 'was', 'administered', 'with', 'b12', 'as', 'of', 'november', '12,', '1995the', 'patient', 'does', 'not', 'need', 'any', 'specific', 'immunization', 'as', 'of', 'now', 'for', 'tendinitis ', 'the', 'following', 'amount', 'has', 'been', 'generated', 'for', '', 'ct', 'scan', '', 'ct', 'scan', 'for', 'tendinitis', 'in', 'both', 'knees', 'medical', 'insurance', 'coverage', '-$1500', '', 'total', 'amount', 'to', 'be', 'paid', '', '$834', 'the', 'following', 'amount', 'has', 'been', 'generated', 'for', 'doctor', 'visit', 'doctor', 'visit', 'and', 'check-up', 'insurance', 'coverage', 'total', 'amount', 'to', 'be', 'paid', 'lab', 'results', 'show', 'severe', 'damage', 'to', 'bones', 'due', 'to', 'ageing ', 'the', 'patient', 'has', 'been', 'prescribed', 'the', 'following', 'medication,', 'the', 'patient', 'is', 'advised', 'to', 'follow', 'as', 'written', 'below,', 'ultimate', 'bone', 'support', 'talbets', 'times', 'a', 'day', '', 'the', 'patient', 'is', 'allergic', 'to', 'ibuprofen', 'the', 'patient', 'is', 'advised', 'to', 'follow', 'the', 'prescribed', 'medicines', 'strictly the', 'patient', 'should', 'try', 'to', 'reduce', 'weight ', 'also,', 'carrying', 'a', 'support', 'stick', 'is', 'advised ', 'the', 'patient', 'has', 'been', 'diagnosed', 'with', 'arthritis the', 'patient', 'suffers', 'from', 'severe', 'pain', 'in', 'knees', 'and', 'is', 'unable', 'to', 'walk', 'independently further', 'tests', 'should', 'confirm', 'the', 'diagnoses ', 'the', 'patient', 'immunization', 'schedule', 'is,', 'synvisc-one®', 'hylan', 'g-f', 'once', 'every', 'month', 'for', 'a', 'period', 'of', '4', 'months', 'the', 'patient', 'has', 'been', 'billed', 'as', 'follows,', 'synvisc-one®', 'hylan', 'injection', 'charges', 'insurance', 'coverage', 'total', 'expense', 'to', 'be', 'paid', 'no', 'tests', 'needed ', 'the', 'patient', 'does', 'not', 'need', 'any', 'medication ', 'the', 'patient', 'bone', 'health', 'is', 'good ', 'regular', 'exercise', 'to', 'be', 'continued ', 'no', 'medication ', 'no', 'allergies', 'recorded ', 'keep', 'up', 'the', 'good', 'exercise', 'routine ', 'healthy', 'bones ', 'no', 'immunization', 'required ', 'the', 'patient', 'has', 'been', 'billed', 'as', 'follows,', 'doctor', 'visit', 'doctor', 'examination', 'charges', 'medical', 'insurance', 'claimed', 'total', 'expenses', 'to', 'be', 'paid']

    # generate a ciphertext
    policy_str = '((Ortho) and (Gynaecology))'
    ctxt = cpabe.encrypt(pk, msg, policy_str)

    # generate a token
    token1 = cpabe.Token(pk, 'tested', key)
    # print(token1)
    # token2 = cpabe.Token(pk, 'world', key)
    # token3 = cpabe.Token(pk, 'python', key)

    # decryption
    b1 = cpabe.decrypt(pk, ctxt, token1)
    print(b1)
    # b2 = cpabe.decrypt(pk, ctxt, token2)
    # b3 = cpabe.decrypt(pk, ctxt, token3)

    # if debug:
    #     print(b1, b2, b3)

    # generate a ciphertext
    # policy_str = '((Ortho) or (Gynaecology) or (Billing))'
    # ctxt = cpabe.encrypt(pk, msg, policy_str)

    # generate a token
    # token1 = cpabe.Token(pk, 'hello', key)
    # token2 = cpabe.Token(pk, 'world', key)
    # token3 = cpabe.Token(pk, 'python', key)

    # decryption
    # b1 = cpabe.decrypt(pk, ctxt, token1)
    # b2 = cpabe.decrypt(pk, ctxt, token2)
    # b3 = cpabe.decrypt(pk, ctxt, token3)

    # if debug:
    #     print(b1, b2, b3)



if __name__ == "__main__":
    debug = True
    main()
